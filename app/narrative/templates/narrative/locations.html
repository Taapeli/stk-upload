{# _templates/narrative/locations.html_ #}
{% extends "/narrative/layout.html" %}
{% block title %}paikkakunnat{% endblock %}
{% block body %}
{{ super() }}
{% import '/narrative/macros.html' as macro %}

<h2>Paikkakuntaluettelo</h2>
{{ macro.menu(4) }}
	<div class="content" id="Individuals">
		<p id="description">
		Tällä sivulla on hakemisto kaikista paikkakunnista ja niiden alla olevista 
		lähinnä alemman tason paikoista.
		</p>
		<div id="alphanav">
			<ul><li><a href="#" title="alkuun">&uarr;</a></li>
        {% for p in locations %}{% set ini = p.pname[0]|list|first %}
            {% if alpha != ini %}{%set alpha = ini %}
                <li><a href="#{{alpha}}" title="Aakkosmenu: {{alpha}}">{{alpha}}</a></li>
            {% endif %}
        {% endfor %}
			</ul>
		</div>
		<table class="IndividualList">
			<thead>
				<tr><th></th>
                    <th style="maxwidth:50%">Paikka, liittyvät paikat</th>
                    <th>Sijainti</th>
				</tr>
			</thead>
			<tbody>
	{% if locations %}
	    {% for p in locations %}{% set ini = p.pname[0]|list|first %}
            <tr><td class="ColumnAlpha">{% if alpha != ini %}{%set alpha = ini %}
	               <a id="{{alpha}}" name="{{alpha}}" title="Palaa alkuun" href="#">{{alpha}}</a>
                {% endif %}</td>
                <td class="ColumnPerson">
                   <div>
                      <a href="/narrative/location={{p.id}}" class="id"
                        title="katso paikan {{p.id}} tapahtumat"
                        id="{{p.id}}">{{p.id}}</a> {{p.pname|join(' • ')}}
                      <small>{{p.type|transl('lt')}}</small>
			    {% if p.uppers[0] %}{% set e = p.uppers[0] %}
						<small>{{e.type|transl('lt_in')}}</small>
						<a href="#{{e.id}}" 
						  title="siirry paikkaan id={{e.id}}">{{e.pname|join(' • ')}}</a>
		        {% endif %}
                   </div>
            {% if p.lowers %}
		           <ul style="margin:0 0 5px 1em;">
		        {% for e in p.lowers|sort(attribute='pname') %}    <li>
	                       <a href="#{{e.id}}"
	                         title="siirry paikkaan id={{e.id}}">{{e.pname|join(' • ')}}</a>
	                       &nbsp;<small>{{e.type|transl('lt')}}</small>
                      </li>
		        {% endfor %}
		           </ul>
	        {% endif %}
	        <td>{% if p.coord %}({{p.coord[0]|round(4)}}, {{p.coord[1]|round(4)}}){% endif %}</td>
	    {% endfor %}
	{% endif %}
				</tr>
			</tbody>
		</table>
	</div>
{% endblock %}
