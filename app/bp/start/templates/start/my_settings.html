{# _start/my_settings.html_ #}
{% extends "start/s_layout.html" %}
{% include "security/_messages.html" %}
{% block title %}{{ _("User Settings") }} (start/my_settings){% endblock %}
{% block body %}
{{ super() }}
{% from "start/s_macros.html" import hamburger_menu with context %}
{# import 'start/s_macros.html' as macro #}

{{ hamburger_menu() }}
<style>
td,th {background: beige;}
</style>

<div id="startdiv">
  <div>
    <h2>{{ _("My Home Page") }}</h2>

    {% if current_user is defined and current_user.is_authenticated %}

    <div class=startbox>
        <h3>{{ _('User') }} {{current_user.username}}</h3>
	     <div><i>{{current_user.name}}</i> 
	        &lt;{{current_user.email}}&gt;
	     </div>
         <div> 
          <h4>{{ _('Change language') }}</h4>
          <form method="post">
          	<div id="lang">
          		<input type="radio" name="lang" value="fi"
          			{% if session.lang == "fi" %} checked {% endif %}
      			>{{ _("Finnish") }}
          		<input type="radio" name="lang" value="sv"
          			{% if session.lang == "sv" %} checked {% endif %}
          		>{{ _("Swedish") }}
          		<input type="radio" name="lang" value="en"
          			{% if session.lang == "en" %} checked {% endif %}
          		>{{ _("English") }}
          	</div>
          	<div class="submit">
                <input type="submit" value="{{ _('Apply') }}" /></div>
            <p>&gt; <a href="{{ referrer }}">{{ _('Go back') }}</a></p>
            <input type="hidden" name="referrer" value="{{ referrer }}" />
         </form>
         </div>
    </div>

    <div class=startbox>
        <h3>{{ _('My Roles') }}</h3>
        <ul>
        {% for role in  roles %}
        	<li>{{role.name}}</li>
        {% endfor %}
        </ul>
    </div>

    <div class=startbox>
        <h3>{{ _('My Data Batches') }}</h3>
        <p>{{ _('The amount of different data nodes connected directly to your candidate Batches.') }}
{# labels = ['Family', 'Note', 'Person']
   user_batches = {'jpek': {'batch': 'jpek 2019-05-03.001', 'Person': 1949, 'Family': 736}}
#}
        <table>
        <tr>
            <th>{{ _('Batch') }}</th>
	        {% for label in labels %}<th>{{label}}</th>
	        {% endfor %}
        </tr>
        {% for key1,item in batches.items() %}
            {% set user0 = user %}
            {% set user, batch = key1.split('/') %}
<!--              <tr><th colspan="{{ labels|length + 1 }}">{{user}}</th></tr> -->
        <tr><td>{{batch}}</td>
            {% for label in labels %}
		      <td class="right"> {{item[label]}} </td>
		    {% endfor %}
		</tr>
		{% endfor %}
        </table>
    </div>

    {% endif %}
  </div>
  <p></p>
</div>
{% endblock %}
