{# start/index_logged.html_ #}
{% extends "start/s_layout.html" %}
{% block title %}{{ _("Isotammi User's Start Page") }}{% endblock %}
{% block body %}
  {{ super() }}
  {% from "start/s_macros.html" import hamburger_menu with context %}

  {{ hamburger_menu( (
   ) ) }}
<style>
div.starters {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    /*height: 120px;*/
    align-items: center;
}
div.starters span {
    padding: 2pt;
    display: inline-flex;
}
div.starters span.typedesc { color: brown; }
div.starters button {
    min-height: 36px;
}
</style>

<div id="startdiv">
  <div>
    <h1>{{ _("User's home page for Isotammi Services") }}</h1>

{% include "flash_messages.html" %}
{% set batch_id = session['batch_id'] %}<!-- current batch '{{batch_id}}' -->

    <div class="row">

{% if current_user.is_authenticated and 
   (current_user.has_role('gedcom') or current_user.has_role('research')) %}
        <div class="startbox gedtools">
            <div style="display: inline-block;">
                <form method="get" action="/gedcom">

                    <h2>{{ _('Gedcom tools') }}</h2>

                    <p>{{ _('Use these Gedcom tools to improve the quality of your own file or any file you have recieved.') }}</p>
                    <p>{{ _('Return the improved file back to your genealogy software.') }}</p>
                    <div class="submit"> 
                        <button type="submit">{{ _('Gedcom tools') }}</button>
                    </div>
                </form>
            </div>
        </div>
{% endif %}

{% if current_user.is_authenticated and current_user.has_role('research') %}
        <div class="startbox">
            <div style="display: inline-block;">

                <h2>{{ _('Manage Materials') }}</h2>

                <form action="/gramps/uploads">
                    <p>{{ _('You may import your new material to Isotammi and work with existing materials.') }}</p>
                    <p>{{ _('You may also check in which phase your materials are.') }}</p>
                    <div class="submit"> 
                        <input type="submit" value="{{ _('Look at your materials') }}" />
                    </div>
                </form>
            </div>
        </div>
{% endif %}           


{% if current_user.is_authenticated and 
   ( current_user.has_role('research') or current_user.has_role('admin') ) %}
        <div class="startbox">
            <div style="display: inline-block;">

                <h2>{{ _('Browse Common Materials') }}</h2>

                <p>{{ _('View different approved common data') }}.</p>
                <form method="get" action="/scene/material/common">
<!--                <input type="hidden" name="set_scope" value="1"> -->
<!--                <input type="hidden" name="state" value="Accepted"> -->
                    <div class="starters">
                        <button type="submit" name="material_type" value="Family Tree"
                            >{{ _("Browse") }}:<br>{{ _('Approved Isotammi tree') }}
                        </button>
                    </div>
                </form>
            </div>
        </div>
{% endif %}

{% if current_user.is_authenticated and 
   ( current_user.has_role('research') or current_user.has_role('admin') ) %}
        <div
    {% if batches|count > 3 %} class="startbox2"
    {% else %} class="startbox"
    {% endif -%}>
            <div style="display: inline-block;">

                <h2>{{ _('My candidate material') }}</h2>

                <p>{{ _('View your own candidate materials') }}.</p>
                <div class="starters">
    {% for root in batches %}
                <form method="post" action="/scene/material/batch">
        {% if root.description %}
                  {% set title = _(root.material_type) + " / " + root.description %}
        {% else %}{% set title = _(root.material_type) %}
        {% endif -%}
                        <span>
                            <input type="hidden" name="material_type" value="{{root.material_type}}">
                            <input type="hidden" name="state" value="{{root.state}}">
                            <button type="submit" name="batch_id" value="{{ root.id }}"
           {% if batch_id == root.id %}autofocus{% endif %}
                             title="{{ title }}">
           {% if root.material_type != "Family Tree" %}
                                <span class="typedesc">{{ _(root.material_type) }}</span>
           {% endif %}
                            {{ root.id }}<br>{{ root.filename()|replace('_',' ') }}
                            </button>
                        </span>
                    </form>
    {% endfor -%}
                 </div>
             </div>
        </div>
{% endif %}


{% if current_user.is_authenticated and 
            (current_user.has_role('admin') or current_user.has_role('master') ) %}
        <div class="startbox admin">
            <div style="display: inline-block;">
                <form method="get" action="/admin">

                    <h2>{{ _('Admin Operations') }}</h2>

                    <p>{{ _('Manage users, reference data sets and do database maintenance tasks') }}.</p>
                    <div class="submit"> 
                        <button type="submit">{{ _('Maintenance') }}</button>
                    </div>
                </form>
            </div>
        </div>
{% endif %}

{% if current_user.is_authenticated and (current_user.has_role('audit') ) %}
        <div class="startbox audit">
            <div style="display: inline-block;">
                <form method="get" action="/audit">

                    <h2>{{ _('Isotammi auditor') }}</h2>

                    <p>{{ _('Operations between user candidate materials and Isotammi database') }}.</p>
                    <div class="submit"> 
                        <button type="submit">{{ _('Audit materials') }}</button>
                    </div>
                </form>
            </div>
        </div>
{% endif %}

        <div class="startbox">
            <div style="display: inline-block;">
                <form method="get" action="http://wiki.isotammi.net/wiki/TyÃ¶kaluja" target="_blank">

                    <h2>{{ _('Tools and Links') }}</h2>

                    <p>{{ _('Study our supplementary stand-alone and Gramps utilities in our tools page') }}.</p>
                    <div class="submit"> 
                        <button type="submit">{{ _('Help page') }}</button>
                    </div>
                </form>
            </div>
        </div>

    </div>{# row #}

  </div>
</div>
{% endblock %}
