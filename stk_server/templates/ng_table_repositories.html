{# _myapp/templates/table1.html_ #}
{% extends "layout.html" %}
{% block title %}Tiedot kannasta{% endblock %}
{% block body %}
{{ super() }}
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
<script src="/static/infobox.js"></script>

<h2>Repositoryluettelo</h2>
<p>Näytetään repositories</p>

<section id="lista">
<div ng-app="myApp" ng-controller="namesCtrl">
	<table>
	    <tr><th ng-click="orderByMe('uniq_id')">uniq_id</th>
	        <th ng-click="orderByMe('rname')">rname</th>
	        <th ng-click="orderByMe('type')">type</th>
	    </tr>
	{% if repositories %}
	    <tr ng-repeat="r in repos | orderBy:myOrderBy">
	        <td>{a r.uniq_id a}</td>
	        <td>{a r.rname a}</td>
    		<td>{a r.type a}</td>
        </tr>
	{% else %}
	        <tr><td colspan="5">Ei tietoja</td></tr>
	{% endif %}
	</table>
</div>

<script>
var app = angular.module('myApp', []).controller('namesCtrl', function($scope) {
    $scope.repos = [
	{% for repo in repositories %}
        {uniq_id:'{{repo.uniq_id}}',rname:'{{repo.rname}}',type:'{{repo.type}}'},
    {% endfor %}
        ];
    $scope.orderByMe = function(x) {
        $scope.myOrderBy = x;
    }
});

app.config(['$interpolateProvider', function($interpolateProvider) {
  $interpolateProvider.startSymbol('{a');
  $interpolateProvider.endSymbol('a}');
}]);
</script>

{% endblock %}
