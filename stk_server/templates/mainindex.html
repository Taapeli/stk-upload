{# templates/mainindex.html_ #}
{% extends "layout.html" %}
{% include "security/_messages.html" %}
{% block title %}Kirjautunut käyttäjä{% endblock %}
{% block body %}
{{ super() }}

<div style="margin-left:50px; padding-bottom: 2em;">
  <div>
    <h2>Tervetuloa Suomikantaan, {{current_user.username}}</h2>
    <p>Käyttäjä <b>{{current_user.name}}</b> &lt;{{current_user.email}}&gt;
       roolit: [ {% for r in current_user.roles %}{{r.name}} {% endfor %} ]</p>
    <div class="row">
       <div class="startbox">
         <div style="display: inline-block;">
           <form method="get" action="/person/list/">
             <h3>Oma sukupuuni</h3>
             <p>Katso omaa ehdokasaineistoasi ja vertaa Suomikantaan</p>
             <div style="text-align:right;"> 
                <button type="submit">Henkilöluettelo</button>
             </div>
           </form>
        </div>
        </div>
          <div class="startbox">
            <div style="display: inline-block;">
               <h3>Tietojen lisääminen</h3>
                 <form action="/upload" method="post"  enctype="multipart/form-data">
	               <div style="display: inline-block;">
	                 <input type="hidden" name="material" value="xml_file">
	                 <p>Valitse Gramps XML-tiedosto (*.gramps) ehdokasaineistoksi</p>
	                 <input type="file" name="filenm" />
	               </div>
                   <div style="text-align:right;"> 
	                 <input type="submit" value="Lataa" />
	               </div>
                </form>
            </div>
        </div>
        <div class="startbox">
           <div style="display: inline-block;">
              <h3>Oma Gedcom-aineistoni</h3>
              <p>Lataa aineistosi Gedcom-muodossa tai muokkaa jä lähetettyä</p>
              <div style="text-align:right;"> 
                    <button type="button"
                     onclick="alert('Toiminto vasta suunnitteilla')">
                     Gedcom-käsittelyt</button>
              </div>
           </div>
        </div>

    {% if current_user.is_authenticated and 
        ( current_user.has_role('member') or current_user.has_role('admin') ) %}
        <div class="startbox">
            <h3>Datanäkymiä taulukkoina</h3>
            <p>Seuraavalla sivulla on erilaisia teknisempiä listauksia
               ja ongelmanselvitysvälineitä
            </p>
            <form method="get" action="/tables">
               <div style="text-align:right;"> 
                  <button type="submit">Tutki tietokantaa</button>
               </div>
            </form>
        </div>
    {% endif %}

        <div class="startbox">
          <div style="display: inline-block;">
            <h3>Viesti ylläpitoon</h3>
            <p>Pyydä tutkijaoikeuksia tai lähetä muu viesti ylläpitoon</p>
            <div style="text-align:right;"> 
              <button type="button" onclick="alert('Toiminto vasta suunnitteilla')">
                Laadi viesti</button>
            </div>
          </div>
        </div>

        {% if current_user.is_authenticated and current_user.has_role('admin') %}
        <div class="startbox admin">
          <div style="display: inline-block;">
			<h3>Ylläpitäjän toiminnot</h3>
			<ul>
              <li><b>Tyhjennä</b> <i>(mitään kysymättä!)</i>
                <ul>
                  <li><a href="/admin/clear_db/total">Tyhjennä koko kanta</li>
                  <li><a href="/admin/clear_db/save_users">Tyhjennä koko kanta,
                      mutta säästä käyttäjätunukset</li>
                  <li><a href="/admin/clear_db/my_own">Tyhjennä kaikki lataamani 
                      henkilö- ja tapahtumatiedot ({{current_user.username}})</li>
              </ul></li>
			  <li><a href="/lista/users">Näytä käyttäjätunnukset</a></li>
			  <li><a href="/refnames">Muokkaa referenssinimiä</a></li>
			  <li><a href="/aseta/estimated_dates">Aseta henkilön arvioidut syntymä- ja kuolinajat</a></li>			</ul>
          </div>
        </div>{% endif %}
     {% if current_user.is_authenticated %}
        <div class="startbox"">
          <h3>Kirjaudu ulos</h3>
          <p>Istunnon lopettaminen<br>&nbsp;</p>
	      <form method="get" action="/logout">
             <div style="text-align:right;"> 
				<button type="submit" style="color: blue">Poistu sovelluksesta</button>
             </div>
		  </form>
        </div>
     {% endif %}
    </div>
  </div>
	
{% endblock %}